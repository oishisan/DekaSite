<?phprequire 'core.php';/*Login algorithm1. Check if php session 'auth' variable is set	-If not, set it to 02. Check if attempting to login3. Query account5. Check if good query6. Count row number match	-If match is 1, perform necessary php session variable storage	-If match is 0, unset variables and set error message	-If match is >1, give warning.*/if(!isset($_SESSION['auth'])){	$_SESSION['auth'] = 0;	authPages($ini, $_SESSION['aSites']);}if (isset($_POST['login']) && $_SESSION['auth'] == 0 && $dbFail <> 1){	$accountInfo = mssql_query("SELECT user_no FROM account.dbo.user_profile WHERE user_id = '".mssql_escape($_POST['accname'])."' AND user_pwd = '".mssql_escape(md5($_POST['accpass']))."' AND login_tag = 'Y'");	if ($accountInfo)	{		$logMatch = mssql_num_rows($accountInfo);		if ($logMatch == "1")		{			$getAccount = mssql_fetch_array($accountInfo);			$_SESSION['accname'] = $_POST['accname'];			$_SESSION['user_no'] = $getAccount[0];			$_SESSION['auth'] = 1;			unset($_SESSION['aSites']);			authPages($ini, $_SESSION['aSites']);		}		elseif ($logMatch == '0')		{			$errormsg = 'Invalid username or password.';		}		else		{			$errormsg = 'Account confliction occured! Please contact your administrator and tell them, "the shit has hit the fan"';		}	}	else	{		echo 'Unable to connect to the database.';		exit(0);	}}?>